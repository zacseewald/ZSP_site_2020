{"ast":null,"code":"var path = require('path'),\n    log = require('npmlog');\n\nfunction findNodeDirectory(scriptLocation, processObj) {\n  // set dirname and process if not passed in\n  // this facilitates regression tests\n  if (scriptLocation === undefined) {\n    scriptLocation = __dirname;\n  }\n\n  if (processObj === undefined) {\n    processObj = process;\n  } // Have a look to see what is above us, to try and work out where we are\n\n\n  npm_parent_directory = path.join(scriptLocation, '../../../..');\n  log.verbose('node-gyp root', 'npm_parent_directory is ' + path.basename(npm_parent_directory));\n  node_root_dir = \"\";\n  log.verbose('node-gyp root', 'Finding node root directory');\n\n  if (path.basename(npm_parent_directory) === 'deps') {\n    // We are in a build directory where this script lives in\n    // deps/npm/node_modules/node-gyp/lib\n    node_root_dir = path.join(npm_parent_directory, '..');\n    log.verbose('node-gyp root', 'in build directory, root = ' + node_root_dir);\n  } else if (path.basename(npm_parent_directory) === 'node_modules') {\n    // We are in a node install directory where this script lives in\n    // lib/node_modules/npm/node_modules/node-gyp/lib or\n    // node_modules/npm/node_modules/node-gyp/lib depending on the\n    // platform\n    if (processObj.platform === 'win32') {\n      node_root_dir = path.join(npm_parent_directory, '..');\n    } else {\n      node_root_dir = path.join(npm_parent_directory, '../..');\n    }\n\n    log.verbose('node-gyp root', 'in install directory, root = ' + node_root_dir);\n  } else {\n    // We don't know where we are, try working it out from the location\n    // of the node binary\n    var node_dir = path.dirname(processObj.execPath);\n    var directory_up = path.basename(node_dir);\n\n    if (directory_up === 'bin') {\n      node_root_dir = path.join(node_dir, '..');\n    } else if (directory_up === 'Release' || directory_up === 'Debug') {\n      // If we are a recently built node, and the directory structure\n      // is that of a repository. If we are on Windows then we only need\n      // to go one level up, everything else, two\n      if (processObj.platform === 'win32') {\n        node_root_dir = path.join(node_dir, '..');\n      } else {\n        node_root_dir = path.join(node_dir, '../..');\n      }\n    } // Else return the default blank, \"\".\n\n  }\n\n  return node_root_dir;\n}\n\nmodule.exports = findNodeDirectory;","map":null,"metadata":{},"sourceType":"script"}